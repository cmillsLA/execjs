<!doctype>
<head></head>
<body>
<div id="content"></div>


<script>
// Append js.
function _appendJS(jsobj, d, selector) {
	var _content = d;
	var _selector = selector;
	var _jsobj = jsobj;
	// Create script tag for inline js.
	if(_jsobj.inline) {
		var script = document.createElement('script');
		script.type = 'text/javascript';
		script.text = _jsobj.inline;
	  document.getElementsByTagName("body")[0].appendChild(script);
	}
	// Write urls for external js.
	if(_jsobj.urls) {
		for(var i=0; i<_jsobj.urls.length; i++) {
			var _url = _jsobj.urls[i];
			document.write('<script type="text/javascript" src="' + _url + '"><\/script>');
		}
	}
	// Append html content.
	_appendHTML(_content, _selector);
}

// Append html.
function _appendHTML(d, selector) {
	if(selector) {
		selector.innerHTML += d;
	} else {
		console.log('Invalid selector provided.');
	}
}

// Append.
function _append(d, selector) {
	var content = d;
	var js = content.match(/<script/g);
	// Javascript and html.
	if(js) {
		var urls = [];
		var inline = '';
		var regInline = /<script[^type="(.*?)">]*>([\s\S]*?)<\/script>/gmi;
		var regSrc = /<script.*?src="(.*?)"><\/script>/gmi;
		// Extract inline javascript.
		content = content.replace(regInline, function(){
			inline += arguments[1] + '\n';
		});
		// Extract external javascript urls.
		content = content.replace(regSrc, function(){
			urls.push(arguments[1]); 
		});
		var jsobj = {
			'inline': inline,
			'urls': urls
		}
		_appendJS(jsobj, content, selector)
	// Html.
	} else {
		_appendHTML(content, selector);
	}
}

var selector = document.getElementById('content');

var d = '<script>alert("inline javascript 1");</\script><h1>html only</h1><h2>subtitle.</h2><script>alert("inline javascript 2");</\script><script>alert("inline javascript 3");</\script><script type="text/javascript" src="http://chrismills.la/test.js"></\script><script>alert("more inline javascript");</\script><p>More Content.</p>';

_append(d, selector);


</script>



</body>
</html>
